<section class="p-4 text-sm">
  <p class="heading-1 mb-2">
    Route Guards
  </p>

  <div class="text-content">
    <p>
      <span class="text-zinc-50 tw-font-medium">Route Guards</span>
      in Angular 19 provide powerful mechanisms for controlling navigation flow, protecting routes, and optimizing user experience. With Angular 19's enhancements, route guards now support signals for reactive state management, functional guard patterns for better tree-shaking, and seamless integration with the standalone component architecture.
    </p>

    <br>

    <div class="flex flex-col">
      <div class="flex border-b border-gray-200">
        <button (click)="selectedTab = 1" [class.text-rose-300]="selectedTab===1" class="text-sky-400 hover:text-rose-400 font-semibold py-2 px-4 border-b-2 border-transparent hover:border-gray-500 focus:outline-none">
          Notes
        </button>
        <button (click)="selectedTab = 2" [class.text-rose-300]="selectedTab===2" class="text-sky-400 hover:text-rose-400 font-semibold py-2 px-4 border-b-2 border-transparent hover:border-gray-500 focus:outline-none">
          Best Practices
        </button>
        <button (click)="selectedTab = 3" [class.text-rose-300]="selectedTab===3" class="text-sky-400 hover:text-rose-400 font-semibold py-2 px-4 border-b-2 border-transparent hover:border-gray-500 focus:outline-none">
          Pros and Cons
        </button>
        <button (click)="selectedTab = 4" [class.text-rose-300]="selectedTab===4" class="text-sky-400 hover:text-rose-400 font-semibold py-2 px-4 border-b-2 border-transparent hover:border-gray-500 focus:outline-none">
          Related Topics
        </button>
      </div>
      <div class="p-4">
        <ng-container [ngSwitch]="selectedTab">
          <div *ngSwitchCase="2">
            <ng-container *ngTemplateOutlet="bestRef;"></ng-container>
          </div>
          <div *ngSwitchCase="3">
            <ng-container *ngTemplateOutlet="prosConsRef;"></ng-container>
          </div>
          <div *ngSwitchCase="4">
            <ng-container *ngTemplateOutlet="topicsRef"></ng-container>
          </div>
          <div *ngSwitchDefault>
            <ng-container *ngTemplateOutlet="notesRef"></ng-container>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</section>

<ng-template #notesRef>
  <p>Why Use Route Guards?</p>
  <ul class="list-disc pl-4 text-sm">
    <li>
      <strong>Access Control</strong>:
      Protect routes from unauthorized access based on user permissions or authentication status.
    </li>
    <li>
      <strong>Navigation Flow Control</strong>:
      Prevent users from leaving routes with unsaved changes or incomplete forms.
    </li>
    <li>
      <strong>Data Pre-loading</strong>:
      Ensure required data is available before activating a route.
    </li>
    <li>
      <strong>Performance Optimization</strong>:
      Control when and how route modules are loaded.
    </li>
  </ul>

  <br>
  <br>

  <p>New Features and Enhancements in Angular 19</p>
  <ol class="list-decimal pl-4 text-sm">
    <li>
      <strong>Signal-Based Guards</strong>:
      <ul class="list-disc pl-4">
        <li>Angular 19 introduces signal-based guards that integrate with Angular's reactivity model for more efficient state management</li>
        <li>Provides cleaner code with fewer subscriptions and improved memory management</li>
      </ul>
    </li>
    <li>
      <strong>Functional Route Guards</strong>:
      <ul class="list-disc pl-4">
        <li>New functional API for creating guards with less boilerplate</li>
        <li>Better tree-shakability for smaller production bundles</li>
        <li>Type-safe implementation with improved TypeScript support</li>
      </ul>
    </li>
    <li>
      <strong>Standalone-Compatible Guards</strong>:
      <ul class="list-disc pl-4">
        <li>First-class support for standalone components and applications</li>
        <li>No NgModule required for guard registration</li>
        <li>Simplified dependency injection pattern</li>
      </ul>
    </li>
    <li>
      <strong>Enhanced Error Handling</strong>:
      <ul class="list-disc pl-4">
        <li>Improved error boundary support for failed guards</li>
        <li>Better debugging tools for guard failures</li>
        <li>More granular control over error recovery strategies</li>
      </ul>
    </li>
    <li>
      <strong>Zoneless Application Support</strong>:
      <ul class="list-disc pl-4">
        <li>Guards that work seamlessly in zoneless applications</li>
        <li>Optimized change detection integration</li>
        <li>Improved performance with reduced overhead</li>
      </ul>
    </li>
  </ol>

  <br>
  <br>

  <p>Types of Route Guards in Angular 19</p>
  <br>
  <table class="w-full border-collapse rounded-lg overflow-hidden shadow-md">
    <thead>
      <tr class="bg-gray-800 text-gray-100">
        <th class="py-3 px-4 text-left">Guard Type</th>
        <th class="py-3 px-4 text-left">Description</th>
      </tr>
    </thead>
    <tbody>
      <tr class="border-b border-gray-700 bg-gray-900 hover:bg-gray-800 transition-colors">
        <td class="py-3 px-4">canActivate</td>
        <td class="py-3 px-4">Determines if a route can be activated</td>
      </tr>
      <tr class="border-b border-gray-700 bg-gray-950 hover:bg-gray-800 transition-colors">
        <td class="py-3 px-4">canActivateChild</td>
        <td class="py-3 px-4">Determines if children of a route can be activated</td>
      </tr>
      <tr class="border-b border-gray-700 bg-gray-900 hover:bg-gray-800 transition-colors">
        <td class="py-3 px-4">canDeactivate</td>
        <td class="py-3 px-4">Determines if a route can be deactivated</td>
      </tr>
      <tr class="border-b border-gray-700 bg-gray-950 hover:bg-gray-800 transition-colors">
        <td class="py-3 px-4">canMatch</td>
        <td class="py-3 px-4">Determines if a route matches the current URL</td>
      </tr>
    </tbody>
  </table>

  <br>
  <br>

  <p>Signal-Based Guard Implementation</p>
  <button (click)="code1.hidden = !code1.hidden" class="border border-rose-400 rounded-md px-1 text-sky-400">code</button>

  <span #code1 hidden copyToClipboard>
    <div class="flex flex-row justify-between items-center bg-gray-900 px-4 py-2 relative top-5">
      <span>typescript</span>
      <span class="copy-button-wrapper bg-gray-700"></span>
    </div>

    <pre>
      <code
        [highlight]="code_1"
        [languages]="['typescript']">
      </code>
    </pre>
  </span>

  <br>
  <p>Functional Router Guard</p>
  <button (click)="code2.hidden = !code2.hidden" class="border border-rose-400 rounded-md px-1 text-sky-400">code</button>

  <span #code2 hidden copyToClipboard>
    <div class="flex flex-row justify-between items-center bg-gray-900 px-4 py-2 relative top-5">
      <span>typescript</span>
      <span class="copy-button-wrapper bg-gray-700"></span>
    </div>

    <pre>
      <code
        [highlight]="code_2"
        [languages]="['typescript']">
      </code>
    </pre>
  </span>

  <br>
  <p>Using Guards with Standalone Components</p>
  <button (click)="code3.hidden = !code3.hidden" class="border border-rose-400 rounded-md px-1 text-sky-400">code</button>

  <span #code3 hidden copyToClipboard>
    <div class="flex flex-row justify-between items-center bg-gray-900 px-4 py-2 relative top-5">
      <span>typescript</span>
      <span class="copy-button-wrapper bg-gray-700"></span>
    </div>

    <pre>
      <code
        [highlight]="code_3"
        [languages]="['typescript']">
      </code>
    </pre>
  </span>

  <br>
  <p>Error Handling in Guards</p>
  <button (click)="code4.hidden = !code4.hidden" class="border border-rose-400 rounded-md px-1 text-sky-400">code</button>

  <span #code4 hidden copyToClipboard>
    <div class="flex flex-row justify-between items-center bg-gray-900 px-4 py-2 relative top-5">
      <span>typescript</span>
      <span class="copy-button-wrapper bg-gray-700"></span>
    </div>

    <pre>
      <code
        [highlight]="code_4"
        [languages]="['typescript']">
      </code>
    </pre>
  </span>

  <br>
  <p>Lazy Loading with Guards</p>
  <button (click)="code5.hidden = !code5.hidden" class="border border-rose-400 rounded-md px-1 text-sky-400">code</button>

  <span #code5 hidden copyToClipboard>
    <div class="flex flex-row justify-between items-center bg-gray-900 px-4 py-2 relative top-5">
      <span>typescript</span>
      <span class="copy-button-wrapper bg-gray-700"></span>
    </div>

    <pre>
      <code
        [highlight]="code_5"
        [languages]="['typescript']">
      </code>
    </pre>
  </span>

  <br>
  <p>Zoneless Guard Implementation</p>
  <button (click)="code6.hidden = !code6.hidden" class="border border-rose-400 rounded-md px-1 text-sky-400">code</button>

  <span #code6 hidden copyToClipboard>
    <div class="flex flex-row justify-between items-center bg-gray-900 px-4 py-2 relative top-5">
      <span>typescript</span>
      <span class="copy-button-wrapper bg-gray-700"></span>
    </div>

    <pre>
      <code
        [highlight]="code_6"
        [languages]="['typescript']">
      </code>
    </pre>
  </span>
</ng-template>

<ng-template #bestRef>
  <ol class="list-decimal px-4 text-sm">
    <li>
      <strong class="text-sky-400">Adopt Functional Guards</strong>
      <ul class="list-disc pl-4">
        <li>
          <strong>Use Functional API</strong>:
          Leverage Angular 19's functional guard API for smaller, more maintainable code with better tree-shaking.
        </li>
        <li>
          <strong>Migrate Incrementally</strong>:
          For existing applications, start by migrating simple guards to the functional pattern first.
        </li>
      </ul>
    </li>
    <li>
      <strong class="text-sky-400">Implement Signal-Based Guards</strong>
      <ul class="list-disc pl-4">
        <li>
          <strong>Reactive State Management</strong>:
          Use signals for reactive state management within guards for better performance and integration with Angular's reactivity system.
        </li>
        <li>
          <strong>Reduce Subscription Management</strong>:
          Minimize Observable subscriptions in favor of signals to avoid memory leaks.
        </li>
      </ul>
    </li>
    <li>
      <strong class="text-sky-400">Optimize for Performance</strong>
      <ul class="list-disc pl-4">
        <li>
          <strong>Keep Guards Lightweight</strong>:
          Guards should execute quickly and not block navigation for extended periods.
        </li>
        <li>
          <strong>Implement Caching</strong>:
          Cache authentication state and other frequently checked conditions to prevent redundant API calls.
        </li>
      </ul>
    </li>
    <li>
      <strong class="text-sky-400">Implement Proper Error Handling</strong>
      <ul class="list-disc pl-4">
        <li>
          <strong>Graceful Degradation</strong>:
          Always handle errors in guards to prevent navigation from breaking completely.
        </li>
        <li>
          <strong>User Feedback</strong>:
          Provide clear feedback when navigation is blocked, explaining why and offering alternatives.
        </li>
      </ul>
    </li>
    <li>
      <strong class="text-sky-400">Structure Routes Effectively</strong>
      <ul class="list-disc pl-4">
        <li>
          <strong>Guard at Appropriate Levels</strong>:
          Apply guards at the highest possible level in the route hierarchy to minimize repetition.
        </li>
        <li>
          <strong>Combine Guard Types Strategically</strong>:
          Use different guard types in combination to create comprehensive navigation control.
        </li>
      </ul>
    </li>
  </ol>
</ng-template>

<ng-template #prosConsRef>
  <div class="flex flex-col gap-4">
    <div>
      <p class="font-semibold text-sky-400">Pros:</p>
      <ul class="list-disc pl-4 text-sm">
        <li>Protects routes from unauthorized access, enhancing application security</li>
        <li>Prevents user navigation away from forms with unsaved changes</li>
        <li>Allows pre-fetching data before activating routes for better user experience</li>
        <li>Signal-based guards in Angular 19 provide improved performance and memory management</li>
        <li>Functional API reduces boilerplate code and improves tree-shaking</li>
        <li>First-class support for standalone components without NgModule requirements</li>
        <li>Enhanced type safety with improved TypeScript integration</li>
      </ul>
    </div>
    <div>
      <p class="font-semibold text-sky-400">Cons:</p>
      <ul class="list-disc pl-4 text-sm">
        <li>Can add complexity to the routing configuration</li>
        <li>May introduce performance overhead if guards perform expensive operations</li>
        <li>Poor implementation can lead to degraded user experience with navigation delays</li>
        <li>Error handling requires careful consideration to prevent navigation from breaking</li>
        <li>Testing guards often requires complex setup with router testing modules</li>
        <li>Managing state across multiple guards can be challenging</li>
        <li>Learning curve for implementing complex guard logic</li>
      </ul>
    </div>
  </div>
</ng-template>

<ng-template #topicsRef>
  <div class="grid grid-cols-2 gap-4 py-2">
    <div class="p-4 border border-gray-700 rounded-lg hover:bg-gray-800 transition-colors">
      <p class="font-medium text-sky-400">Angular Router</p>
      <p class="text-sm">Core routing system that guards integrate with to control navigation flow</p>
    </div>
    <div class="p-4 border border-gray-700 rounded-lg hover:bg-gray-800 transition-colors">
      <p class="font-medium text-sky-400">Authentication</p>
      <p class="text-sm">Common use case for route guards, protecting content based on user identity</p>
    </div>
    <div class="p-4 border border-gray-700 rounded-lg hover:bg-gray-800 transition-colors">
      <p class="font-medium text-sky-400">Route Resolvers</p>
      <p class="text-sm">Complementary feature for pre-fetching data before route activation</p>
    </div>
    <div class="p-4 border border-gray-700 rounded-lg hover:bg-gray-800 transition-colors">
      <p class="font-medium text-sky-400">Signals</p>
      <p class="text-sm">Angular's reactivity primitive that powers modern guard implementations</p>
    </div>
    <div class="p-4 border border-gray-700 rounded-lg hover:bg-gray-800 transition-colors">
      <p class="font-medium text-sky-400">Lazy Loading</p>
      <p class="text-sm">Loading modules on demand, often protected by guards for access control</p>
    </div>
    <div class="p-4 border border-gray-700 rounded-lg hover:bg-gray-800 transition-colors">
      <p class="font-medium text-sky-400">Form Protection</p>
      <p class="text-sm">Using canDeactivate guards to prevent accidental navigation away from forms</p>
    </div>
  </div>
</ng-template>
