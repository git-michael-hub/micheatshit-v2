<section class="p-4 text-sm">
  <p class="heading-1 mb-2">
    DI Token
  </p>

  <div class="text-content">
    <p>
      <span class="text-zinc-50 tw-font-medium">Dependency Injection (DI) Tokens</span>
      in Angular 19 are unique identifiers used by the injector to locate and provide dependencies. Tokens act as keys in Angular's dependency injection system, enabling more flexible, type-safe dependency management with improved performance in the latest version.
    </p>

    <br>

    <div class="flex flex-col">
      <div class="flex border-b border-gray-200">
        <button (click)="selectedTab = 1" [class.text-rose-300]="selectedTab===1" class="text-sky-400 hover:text-rose-400 font-semibold py-2 px-4 border-b-2 border-transparent hover:border-gray-500 focus:outline-none">
          Notes
        </button>
        <button (click)="selectedTab = 2" [class.text-rose-300]="selectedTab===2" class="text-sky-400 hover:text-rose-400 font-semibold py-2 px-4 border-b-2 border-transparent hover:border-gray-500 focus:outline-none">
          Best Practices
        </button>
        <button (click)="selectedTab = 3" [class.text-rose-300]="selectedTab===3" class="text-sky-400 hover:text-rose-400 font-semibold py-2 px-4 border-b-2 border-transparent hover:border-gray-500 focus:outline-none">
          Pros and Cons
        </button>
        <button (click)="selectedTab = 4" [class.text-rose-300]="selectedTab===4" class="text-sky-400 hover:text-rose-400 font-semibold py-2 px-4 border-b-2 border-transparent hover:border-gray-500 focus:outline-none">
          Related Topics
        </button>
      </div>
      <div class="p-4">
        <ng-container [ngSwitch]="selectedTab">
          <div *ngSwitchCase="2">
            <ng-container *ngTemplateOutlet="bestRef;"></ng-container>
          </div>
          <div *ngSwitchCase="3">
            <ng-container *ngTemplateOutlet="prosConsRef;"></ng-container>
          </div>
          <div *ngSwitchCase="4">
            <ng-container *ngTemplateOutlet="topicsRef"></ng-container>
          </div>
          <div *ngSwitchDefault>
            <ng-container *ngTemplateOutlet="notesRef"></ng-container>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</section>

<ng-template #notesRef>
  <p>Types of DI Tokens in Angular 19:</p>
  <ol class="list-decimal px-10 text-sm">
    <li>
      <strong>Class Tokens</strong>: The most common type, using the class itself as its own token.

      <button (click)="code1.hidden = !code1.hidden" class="border border-rose-400 rounded-md px-1 text-sky-400">code</button>

      <span #code1 hidden copyToClipboard>
        <div class="flex flex-row justify-between items-center bg-gray-900 px-4 py-2 relative top-5">
          <span>typescript</span>
          <span class="copy-button-wrapper bg-gray-700"></span>
        </div>

        <pre>
          <code
            [highlight]="code_1"
            [languages]="['typescript']">
          </code>
        </pre>
      </span>
    </li>
    <li>
      <strong>InjectionToken</strong>: A token that creates a unique identifier for non-class dependencies.

      <button (click)="code2.hidden = !code2.hidden" class="border border-rose-400 rounded-md px-1 text-sky-400">code</button>

      <span #code2 hidden copyToClipboard>
        <div class="flex flex-row justify-between items-center bg-gray-900 px-4 py-2 relative top-5">
          <span>typescript</span>
          <span class="copy-button-wrapper bg-gray-700"></span>
        </div>

        <pre>
          <code
            [highlight]="code_2"
            [languages]="['typescript']">
          </code>
        </pre>
      </span>
    </li>
    <li>
      <strong>String Tokens</strong>: Legacy string tokens, less commonly used in Angular 19 due to lack of type safety.

      <button (click)="code3.hidden = !code3.hidden" class="border border-rose-400 rounded-md px-1 text-sky-400">code</button>

      <span #code3 hidden copyToClipboard>
        <div class="flex flex-row justify-between items-center bg-gray-900 px-4 py-2 relative top-5">
          <span>typescript</span>
          <span class="copy-button-wrapper bg-gray-700"></span>
        </div>

        <pre>
          <code
            [highlight]="code_3"
            [languages]="['typescript']">
          </code>
        </pre>
      </span>
    </li>
  </ol>

  <br>
  <br>

  <p>New DI Token Features in Angular 19</p>
  <ol class="list-decimal px-10 text-sm">
    <li>
      <strong>Enhanced Type Safety</strong>:
      Angular 19 strengthens type checking for tokens, particularly with improved generic type inference for InjectionToken.

      <button (click)="code4.hidden = !code4.hidden" class="border border-rose-400 rounded-md px-1 text-sky-400">code</button>

      <span #code4 hidden copyToClipboard>
        <div class="flex flex-row justify-between items-center bg-gray-900 px-4 py-2 relative top-5">
          <span>typescript</span>
          <span class="copy-button-wrapper bg-gray-700"></span>
        </div>

        <pre>
          <code
            [highlight]="code_4"
            [languages]="['typescript']">
          </code>
        </pre>
      </span>
    </li>
    <li>
      <strong>Signal Integration</strong>:
      Angular 19 introduces better integration between tokens and signals for reactive dependencies.

      <button (click)="code5.hidden = !code5.hidden" class="border border-rose-400 rounded-md px-1 text-sky-400">code</button>

      <span #code5 hidden copyToClipboard>
        <div class="flex flex-row justify-between items-center bg-gray-900 px-4 py-2 relative top-5">
          <span>typescript</span>
          <span class="copy-button-wrapper bg-gray-700"></span>
        </div>

        <pre>
          <code
            [highlight]="code_5"
            [languages]="['typescript']">
          </code>
        </pre>
      </span>
    </li>
    <li>
      <strong>Performance Improvements</strong>:
      Angular 19 optimizes token resolution for faster dependency injection, especially with providedIn.

      <button (click)="code6.hidden = !code6.hidden" class="border border-rose-400 rounded-md px-1 text-sky-400">code</button>

      <span #code6 hidden copyToClipboard>
        <div class="flex flex-row justify-between items-center bg-gray-900 px-4 py-2 relative top-5">
          <span>typescript</span>
          <span class="copy-button-wrapper bg-gray-700"></span>
        </div>

        <pre>
          <code
            [highlight]="code_6"
            [languages]="['typescript']">
          </code>
        </pre>
      </span>
    </li>
  </ol>

  <br>
  <br>

  <p>Common DI Token Usage Patterns in Angular 19</p>
  <table class="w-full border-collapse rounded-lg overflow-hidden shadow-md">
    <thead>
      <tr class="bg-gray-800 text-gray-100">
        <th class="py-3 px-4 text-left">Token Type</th>
        <th class="py-3 px-4 text-left">Best Used For</th>
      </tr>
    </thead>
    <tbody>
      <tr class="border-b border-gray-700 bg-gray-900 hover:bg-gray-800 transition-colors">
        <td class="py-3 px-4"><code>Class Token</code></td>
        <td class="py-3 px-4">Service instances where the class itself is the token</td>
      </tr>
      <tr class="border-b border-gray-700 bg-gray-950 hover:bg-gray-800 transition-colors">
        <td class="py-3 px-4"><code>InjectionToken</code></td>
        <td class="py-3 px-4">Non-class dependencies like primitive values, objects, or functions</td>
      </tr>
      <tr class="border-b border-gray-700 bg-gray-900 hover:bg-gray-800 transition-colors">
        <td class="py-3 px-4"><code>Multi-provider tokens</code></td>
        <td class="py-3 px-4">Arrays of values where multiple providers contribute to a collection</td>
      </tr>
      <tr class="border-b border-gray-700 bg-gray-950 hover:bg-gray-800 transition-colors">
        <td class="py-3 px-4"><code>Optional tokens</code></td>
        <td class="py-3 px-4">Dependencies that aren't required and may not be available</td>
      </tr>
    </tbody>
  </table>
</ng-template>

<ng-template #bestRef>
  <ol class="list-decimal px-4 text-sm">
    <li>
      <strong class="text-sky-400">Use InjectionToken for Non-Class Dependencies</strong>
      <ul class="list-disc pl-4">
        <li>
          <strong>Prefer InjectionToken Over String Tokens</strong>:
          Always use InjectionToken instead of string tokens in Angular 19 applications to ensure type safety and better debugging.
        </li>
        <li>
          <strong>Include Descriptive Token Names</strong>:
          Provide meaningful names to InjectionToken constructors to make debugging easier when dependency resolution fails.
        </li>
      </ul>
    </li>
    <li>
      <strong class="text-sky-400">Leverage Token Factories</strong>:
      <ul class="list-disc pl-4">
        <li>
          <strong>Use Factory Functions with ProvidedIn</strong>:
          In Angular 19, define token factories with the providedIn option for better tree-shaking and initialization performance.
        </li>
        <li>
          <strong>Keep Factories Pure</strong>:
          Ensure token factory functions remain pure and deterministic to avoid unexpected behavior and facilitate testing.
        </li>
      </ul>
    </li>
    <li>
      <strong class="text-sky-400">Design for Hierarchical Injection</strong>:
      <ul class="list-disc pl-4">
        <li>
          <strong>Organize Tokens by Scope</strong>:
          Plan which injector level each token belongs toâ€”root, platform, standalone component, or NgModule (legacy).
        </li>
        <li>
          <strong>Use Environment-Specific Tokens</strong>:
          Create separate tokens for environment-specific values to switch between development, testing, and production configurations.
        </li>
      </ul>
    </li>
    <li>
      <strong class="text-sky-400">Integrate with Signals</strong>:
      <ul class="list-disc pl-4">
        <li>
          <strong>Provide Signal-Based Dependencies</strong>:
          For reactive configuration in Angular 19, use InjectionTokens that provide signal values for automatic change detection.
        </li>
        <li>
          <strong>Combine with Computed Signals</strong>:
          When injecting signal tokens, pair them with computed signals to derive reactive values without external libraries.
        </li>
      </ul>
    </li>
    <li>
      <strong class="text-sky-400">Multi-Provider Best Practices</strong>:
      <ul class="list-disc pl-4">
        <li>
          <strong>Design for Extensibility</strong>:
          Use multi-providers with tokens when designing extensible systems where multiple providers can contribute values.
        </li>
        <li>
          <strong>Type Arrays Properly</strong>:
          Ensure multi-provider tokens have properly typed arrays (InjectionToken&lt;YourType[]&gt;) to maintain type safety.
        </li>
      </ul>
    </li>
  </ol>
</ng-template>

<ng-template #prosConsRef>
  <strong class="text-sky-400">
    Pros of DI Tokens in Angular 19:
  </strong>

  <ol class="list-decimal px-4 text-sm">
    <li>
      <strong>Improved Type Safety</strong>
      <ul class="list-disc pl-4">
        <li>
          Angular 19 enhances type inference for InjectionToken, reducing runtime errors with better compile-time checking.
        </li>
      </ul>
    </li>
    <li>
      <strong>Better Tree-Shaking</strong>
      <ul class="list-disc pl-4">
        <li>
          Tokens with providedIn configurations enable more effective tree-shaking in Angular 19, reducing bundle sizes.
        </li>
      </ul>
    </li>
    <li>
      <strong>Signal Integration</strong>
      <ul class="list-disc pl-4">
        <li>
          New in Angular 19, tokens can seamlessly provide and work with signals for better reactivity without RxJS.
        </li>
      </ul>
    </li>
    <li>
      <strong>Enhanced Debugging</strong>
      <ul class="list-disc pl-4">
        <li>
          Angular 19 improves error messages for token resolution failures, making dependency issues easier to diagnose.
        </li>
      </ul>
    </li>
    <li>
      <strong>Standalone-Friendly</strong>
      <ul class="list-disc pl-4">
        <li>
          Tokens in Angular 19 work seamlessly with standalone components and the new module-less architecture.
        </li>
      </ul>
    </li>
  </ol>

  <br>

  <strong class="text-sky-400">
    Cons and Challenges:
  </strong>

  <ol class="list-decimal px-4 text-sm">
    <li>
      <strong>Learning Curve</strong>
      <ul class="list-disc pl-4">
        <li>
          InjectionToken concepts can be complex for developers new to Angular, especially with the signal integration in Angular 19.
        </li>
      </ul>
    </li>
    <li>
      <strong>Configuration Overhead</strong>
      <ul class="list-disc pl-4">
        <li>
          Setting up tokens properly requires more boilerplate code compared to direct service usage.
        </li>
      </ul>
    </li>
    <li>
      <strong>Debugging Complexity</strong>
      <ul class="list-disc pl-4">
        <li>
          Despite improvements, tracking down issues with incorrectly configured tokens can still be challenging.
        </li>
      </ul>
    </li>
    <li>
      <strong>Migration Challenges</strong>
      <ul class="list-disc pl-4">
        <li>
          Updating legacy applications to use modern token patterns (like converting string tokens to InjectionToken) requires effort.
        </li>
      </ul>
    </li>
    <li>
      <strong>Potential for Misuse</strong>
      <ul class="list-disc pl-4">
        <li>
          Overusing tokens for simple scenarios can introduce unnecessary abstraction and complexity.
        </li>
      </ul>
    </li>
  </ol>
</ng-template>

<ng-template #topicsRef>
  <p>Related Angular 19 Topics:</p>
  <ol class="list-decimal px-4 text-sm">
    <li>
      <strong>Dependency Injection System</strong>:
      <p>
        DI tokens are fundamental building blocks in Angular's dependency injection system, which has been enhanced in Angular 19 with performance optimizations.
      </p>
    </li>
    <li>
      <strong>Signals Architecture</strong>:
      <p>
        Angular 19 integrates tokens with the signals architecture, enabling reactive applications without RxJS dependencies.
      </p>
    </li>
    <li>
      <strong>Standalone Components</strong>:
      <p>
        Tokens work seamlessly with standalone components in Angular 19, supporting the new module-less architecture.
      </p>
    </li>
    <li>
      <strong>Zoneless Applications</strong>:
      <p>
        DI tokens play a crucial role in zoneless Angular 19 applications by providing signal-based dependencies for change detection.
      </p>
    </li>
    <li>
      <strong>Server-Side Rendering (SSR)</strong>:
      <p>
        Angular 19 improves how tokens work with SSR and hydration, ensuring consistent dependency resolution between server and client.
      </p>
    </li>
    <li>
      <strong>Environment Injection</strong>:
      <p>
        Tokens facilitate environment-specific configuration in Angular 19, making it easier to switch between development, testing, and production settings.
      </p>
    </li>
    <li>
      <strong>Multi-Providers</strong>:
      <p>
        Angular 19 enhances multi-provider tokens, which allow multiple providers to contribute values to a single token.
      </p>
    </li>
  </ol>
</ng-template>
